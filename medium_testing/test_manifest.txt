# This file is read/parsed by test_grafanc.pl
# It includes the following pipe (|) delimited columns:

# Test Name | Executable | Input File | Race File | Options | Output File | File Expected | Output Msg

# Test Name:     Name of the test case
# Executable:    Name of the executable being tested
# Input File:    The name of the input file required by the program
# Race File:     The name of the self-report subject race file
# Options:       Other optional parameter settings
# Output File:   Output file generated by the program
# File expected: If the output file is expected to be generated (Y = Yes)
# Output Msg:    Expected key string included in STDOUT output message

############### The following test cases test C++ program grafanc

### Test PLINK sets

# grafanc with TGP PLINK set GB37
GrafAnc with TGP PLINK GB37 | grafanc | TGP_40_50K_gb37.bed | | --threads 4 | TGP_40_50K_gb37_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set GB 38
GrafAnc with TGP PLINK GB38 | grafanc | TGP_40_50K_gb38.bed | | --threads 4 | TGP_40_50K_gb38_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set RS ID
GrafAnc with TGP PLINK RS ID | grafanc | TGP_40_50K_rs.bed | | --threads 4 | TGP_40_50K_rs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set dup subjects
GrafAnc with TGP PLINK dup sbjs | grafanc | TGP_50_1K_dup_sbjs.bed | | --threads 4 | TGP_50_1K_dup_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set dup SNPss
GrafAnc with TGP PLINK dup SNPs | grafanc | TGP_50_1K_dup_SNPs.bed | | --threads 4 | TGP_50_1K_dup_SNPs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set fewer subjects in fam
GrafAnc with TGP PLINK fewer sbjs | grafanc | TGP_50_1K_few_sbjs.bed | | --threads 4 | TGP_50_1K_few_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set more subjects in fam
GrafAnc with TGP PLINK more sbjs | grafanc | TGP_50_1K_more_sbjs.bed | | --threads 4 | TGP_50_1K_more_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set with flipped alleles 
GrafAnc with TGP PLINK flipped sbjs | grafanc | TGP_50_1K_flip3.bed | | --threads 4 | TGP_50_1K_flip3_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set with multi allele SNPs
GrafAnc with TGP PLINK multi allele SNPs | grafanc | TGP_50_1K_multi5.bed | | --threads 4 | TGP_50_1K_multi5_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set without fam file
GrafAnc with TGP PLINK without fam | grafanc | TGP_10_1K_nofam.bed | | | TGP_10_1K_nofam_pops.txt | | ERROR: didn't find

# grafanc with TGP PLINK set without bim file
GrafAnc with TGP PLINK without bim | grafanc | TGP_10_1K_nobim.bed | | | TGP_10_1K_nobim_pops.txt | | ERROR: didn't find

# grafanc with TGP PLINK set with extra SNPs in bim file
GrafAnc with TGP PLINK with longer bim | grafanc | TGP_10_1K_longbim.bed | | | TGP_10_1K_longbim_pops.txt | Y | Please check the PLINK

# grafanc with TGP PLINK set with fewer SNPs in bim file
GrafAnc with TGP PLINK with shorter bim | grafanc | TGP_10_1K_shortbim.bed | | | TGP_10_1K_shortbim_pops.txt | Y | Please check the PLINK

# grafanc with TGP PLINK set with extra samples in fam file
GrafAnc with TGP PLINK with longer fam | grafanc | TGP_10_1K_longfam.bed | | | TGP_10_1K_longfam_pops.txt | Y | Please check the PLINK

# grafanc with TGP PLINK set with fewer samples in fam file
GrafAnc with TGP PLINK with shorter fam | grafanc | TGP_10_1K_shortfam.bed | | | TGP_10_1K_shortfam_pops.txt | Y | Please check the PLINK

# grafanc with TGP PLINK call without extention
GrafAnc with TGP PLINK no ext | grafanc | TGP_40_50K_rs | | --threads 4 | TGP_40_50K_noext_pops.txt | Y | Saved population results


### Test VCF files

# grafanc with incorrect file name
Incorrect file name | grafanc | TG_wrong_name.bed | | --threads 4 | TG_wrong_name.txt | | ERROR: Genotype file

# grafanc with a vcf file
GrafAnc with VCF.gz | grafanc | TGP_20_10K.vcf | | --threads 4 | TGP_20_10K_pops.txt | Y | Saved population results

# grafanc with a vcf.gz GB 37 file
GrafAnc with VCFGZ GB37 | grafanc | TGP_50_10K_gb37.vcf.gz | | --threads 4 | TGP_50_10K_gb37_pops.txt | Y | Saved population results

# grafanc with a vcf.gz GB38 file
GrafAnc with VCFGZ GB38 | grafanc | TGP_50_10K_gb38.vcf.gz | | --threads 4 | TGP_50_10K_gb378_pops.txt | Y | Saved population results

# grafanc with a vcf.gz RS ID file
GrafAnc with VCFGZ RS ID | grafanc | TGP_50_10K_rs.vcf.gz | | --threads 4 | TGP_50_10K_rs_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with swaped alleles
GrafAnc with VCFGZ swap alleles | grafanc | TGP_50_10K_gb37_swap100.vcf.gz | | --threads 4 | TGP_50_10K_swap100_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with swaped alleles and genos
GrafAnc with VCFGZ swap alleles and genos | grafanc | TGP_50_10K_gb37_swap2.vcf.gz | | --threads 4 | TGP_50_10K_swap2_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with flipped alleles
GrafAnc with VCFGZ flip alleles | grafanc | TGP_50_10K_gb37_flip3.vcf.gz | | --threads 4 | TGP_50_10K_flip3_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with flipped alt alleles
GrafAnc with VCFGZ flip alts | grafanc | TGP_50_10K_gb37_flipAlt5.vcf.gz | | --threads 4 | TGP_50_10K_flip5_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with duplicated SNPs
GrafAnc with VCFGZ dup SNPs | grafanc | TGP_50_10K_gb37_dup20.vcf.gz | | --threads 4 | TGP_50_10K_dup20_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with multi-alleles
GrafAnc with VCFGZ multi-alleles | grafanc | TGP_50_10K_gb37_multi10.vcf.gz | | --threads 4 | TGP_50_10K_multi10_pops.txt | Y | Saved population results

# grafanc with a vcf file but actual vcf.gz
GrafAnc with VCF wrong extension | grafanc | TGP_10_5K_gz.vcf | | | TGP_10_5K_gzvcf_pops.txt | Y | Saved population results

# grafanc with a vcf file without enough ancestry SNPs
GrafAnc with VCF no enough anc SNPs | grafanc | TGP_26_1K.vcf.gz | | | TGP_26_1K_pops.txt | | Ancestry inference not done due to lack

# grafanc with a vcf file without Ancestry SNPs
GrafAnc with VCF wrong extension | grafanc | TGP_2_invalid_snp_chr23.vcf | | | TGP_2_invalid_snp_chr23_pops.txt | | Ancestry inference not done due to lack


############### The following test cases test Perl script ExtractAncSnpsFromVcfGz.pl

# Extract ancestry SNP genos from one vcf file
Extract genos from one vcf | ExtractAncSnpsFromVcfGz.pl | TGP_10_chr4.vcf.gz | | | TGP_10_chr4_anc.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf gz files
Extract genos from multi vcf gz | ExtractAncSnpsFromVcfGz.pl | TGP_10_chr4.vcf.gz | | chr | TGP_10_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf files
Extract genos from multi vcf | ExtractAncSnpsFromVcfGz.pl | TGP_5_chr2.vcf | | chr | TG_5_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos with wrong keyword
Extract genos from multi vcf | ExtractAncSnpsFromVcfGz.pl | TGP_5_chr2.vcf | | smp | TG_5_cmb.vcf | | ERROR: didn't find keyword
