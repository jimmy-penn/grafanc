# This file is read/parsed by test_grafanc.pl
# It includes the following pipe (|) delimited columns:

# Test Name | Executable | Input File | Race File | Options | Output File | File Expected | Output Msg

# Test Name:     Name of the test case
# Executable:    Name of the executable being tested
# Input File:    The name of the input file required by the program
# Race File:     The name of the self-report subject race file
# Options:       Other optional parameter settings
# Output File:   Output file generated by the program
# File expected: If the output file is expected to be generated (Y = Yes)
# Output Msg:    Expected key string included in STDOUT output message

############### The following test cases test C++ program grafanc

### Test PLINK sets

# grafanc with TGP PLINK set GB37
GrafAnc with TGP PLINK GB37 | grafanc | TGP_40_50K_gb37.bed | | --threads 4 | TGP_40_50K_gb37_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set GB 38
GrafAnc with TGP PLINK GB38 | grafanc | TGP_40_50K_gb38.bed | | --threads 4 | TGP_40_50K_gb38_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set RS ID
GrafAnc with TGP PLINK RS ID | grafanc | TGP_40_50K_rs.bed | | --threads 4 | TGP_40_50K_rs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set dup subjects
GrafAnc with TGP PLINK dup sbjs | grafanc | TGP_50_1K_dup_sbjs.bed | | --threads 4 | TGP_50_1K_dup_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set dup SNPss
GrafAnc with TGP PLINK dup SNPs | grafanc | TGP_50_1K_dup_SNPs.bed | | --threads 4 | TGP_50_1K_dup_SNPs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set fewer subjects in fam
GrafAnc with TGP PLINK fewer sbjs | grafanc | TGP_50_1K_few_sbjs.bed | | --threads 4 | TGP_50_1K_few_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set more subjects in fam
GrafAnc with TGP PLINK more sbjs | grafanc | TGP_50_1K_more_sbjs.bed | | --threads 4 | TGP_50_1K_more_sbjs_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set with flipped alleles 
GrafAnc with TGP PLINK flipped sbjs | grafanc | TGP_50_1K_flip3.bed | | --threads 4 | TGP_50_1K_flip3_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set with multi allele SNPs
GrafAnc with TGP PLINK multi allele SNPs | grafanc | TGP_50_1K_multi5.bed | | --threads 4 | TGP_50_1K_multi5_pops.txt | Y | Saved population results

# grafanc with TGP PLINK set without fam file
GrafAnc with TGP PLINK without fam | grafanc | TGP_10_1K_nofam.bed | | | TGP_10_1K_nofam_pops.txt | Y | ERROR: didn't find

# grafanc with TGP PLINK set without bim file
GrafAnc with TGP PLINK without bim | grafanc | TGP_10_1K_nobim.bed | | | TGP_10_1K_nobim_pops.txt | Y | ERROR: didn't find

# grafanc with TGP PLINK call without extention
GrafAnc with TGP PLINK no ext | grafanc | TGP_40_50K_rs | | --threads 4 | TGP_40_50K_noext_pops.txt | Y | Saved population results


### Test VCF files

# grafanc with incorrect file name
Incorrect file name | grafanc | TG_wrong_name.bed | | --threads 4 | TG_wrong_name.txt | | ERROR: Genotype file

# grafanc with a vcf file
GrafAnc with VCF.gz | grafanc | TGP_20_10K.vcf | | --threads 4 | TGP_20_10K_pops.txt | Y | Saved population results

# grafanc with a vcf.gz GB 37 file
GrafAnc with VCFGZ GB37 | grafanc | TGP_50_10K_gb37.vcf.gz | | --threads 4 | TGP_50_10K_gb37_pops.txt | Y | Saved population results

# grafanc with a vcf.gz GB38 file
GrafAnc with VCFGZ GB38 | grafanc | TGP_50_10K_gb38.vcf.gz | | --threads 4 | TGP_50_10K_gb378_pops.txt | Y | Saved population results

# grafanc with a vcf.gz RS ID file
GrafAnc with VCFGZ RS ID | grafanc | TGP_50_10K_rs.vcf.gz | | --threads 4 | TGP_50_10K_rs_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with swaped alleles
GrafAnc with VCFGZ swap alleles | grafanc | TGP_50_10K_gb37_swap100.vcf.gz | | --threads 4 | TGP_50_10K_swap100_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with swaped alleles and genos
GrafAnc with VCFGZ swap alleles and genos | grafanc | TGP_50_10K_gb37_swap2.vcf.gz | | --threads 4 | TGP_50_10K_swap2_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with flipped alleles
GrafAnc with VCFGZ flip alleles | grafanc | TGP_50_10K_gb37_flip3.vcf.gz | | --threads 4 | TGP_50_10K_flip3_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with flipped alt alleles
GrafAnc with VCFGZ flip alts | grafanc | TGP_50_10K_gb37_flipAlt5.vcf.gz | | --threads 4 | TGP_50_10K_flip5_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with duplicated SNPs
GrafAnc with VCFGZ dup SNPs | grafanc | TGP_50_10K_gb37_dup20.vcf.gz | | --threads 4 | TGP_50_10K_dup20_pops.txt | Y | Saved population results

# grafanc with a vcf.gz file with multi-alleles
GrafAnc with VCFGZ multi-alleles | grafanc | TGP_50_10K_gb37_multi10.vcf.gz | | --threads 4 | TGP_50_10K_multi10_pops.txt | Y | Saved population results

# grafanc with a vcf file but actual vcf.gz
GrafAnc with VCF wrong extension | grafanc | TGP_10_5K_gz.vcf | | | TGP_10_5K_gzvcf_pops.txt | Y | Saved population results

# grafanc with a vcf file without enough ancestry SNPs
GrafAnc with VCF no enough anc SNPs | grafanc | TGP_26_1K.vcf.gz | | | TGP_26_1K_pops.txt | Y | Ancestry inference not done due to lack

# grafanc with a vcf file without Ancestry SNPs
GrafAnc with VCF wrong extension | grafanc | TGP_2_invalid_snp_chr23.vcf | | | TGP_2_invalid_snp_chr23_pops.txt | Y | Ancestry inference not done due to lack


############### The following test cases test Perl script ExtractAncSnpsFromVcfGz.pl

# Extract ancestry SNP genos from one vcf file
Extract genos from one vcf | ExtractAncSnpsFromVcfGz.pl | TGP_10_chr4.vcf.gz | | | TGP_10K_chr4_anc.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf gz files
Extract genos from multi vcf gz | ExtractAncSnpsFromVcfGz.pl | TGP_10_chr4.vcf.gz | | chr | TGP_10_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos from multiple vcf files
Extract genos from multi vcf | ExtractAncSnpsFromVcfGz.pl | TGP_5_chr2.vcf | | chr | TG_5_cmb.vcf | Y | Results saved to

# Extract ancestry SNP genos with wrong keyword
Extract genos from multi vcf | ExtractAncSnpsFromVcfGz.pl | TGP_5_chr2.vcf | | smp | TG_5_cmb.vcf | Y | ERROR: didn't find keyword


END

# grafanc with GB37 chr pop in bim
GrafAnc with GB37 | grafanc | TG_10_1000_g37.bed | | | TG_10_1000_g37_pops.txt | Y | GRCh 37 chromosome positions are used 

# grafanc with GB38 chr pop in bim
GrafAnc with GB38 | grafanc | TG_10_1000_g38.bed | | | TG_10_1000_g38_pops.txt | Y | GRCh 38 chromosome positions are used 

# grafanc with PLINK of not enough ancestry SNPs
Not enough ancestry SNPs | grafanc | TG_50_20.bed | | | TG_50_2000_pops.txt | | Ancestry inference not done

# grafanc with PLINK of not enough genotyped SNPs
Not enough genotyped SNPs | grafanc | TG_10_120_invalid.bed | | | TG_10_120_pops.txt | | NOTE: None of

# grafanc with PLINK of wrong number of samples
Wrong fam file | grafanc | TG_wrong_smps.bed | | | TG_wrong_smps.txt | | ERROR: Number of genotypes in bed

# grafanc with PLINK of wrong number of SNPs
Wrong bim file | grafanc | TG_wrong_snps.bed | | | TG_wrong_snps.txt | | ERROR: Number of genotypes in bed

# grafanc with PLINK of missing fam
Missing fam file | grafanc | TG_10_1000_nofam.bed | | | TG_10_1000_nofam.txt | | ERROR: didn't find

# grafanc with PLINK of missing bim
Missing bim file | grafanc | TG_10_1000_nobim.bed | | | TG_10_1000_nobim.txt | | ERROR: didn't find


# grafanc with invalid vcf file
Invalid VCF | grafanc | TG_invalid.vcf | | | TG_invalid.txt | | ERROR: didn't find #CHROM row

# grafanc with empty vcf
Empty VCF | grafanc | TG_empty.vcf | | | TG_empty_vcf.txt | | ERROR: doesn't include samples

# grafanc with no valid SNP vcf
No ancestry SNP VCF | grafanc | TG_2_invalid_snp_chr23.vcf | | | TG_no_anc_snp_vcf.txt | | WARNING: Ancestry inference not done due to lack of genotyped

# grafanc with wrong sample vcf
Wrong sample VCF | grafanc | TG_wrong_smps.vcf | | | TG_wrong_smps_vcf.txt | | ERROR is different from #samples


############### The following test cases test Perl script PlotGrafPopResults.pl

# Plot results with default settings
Plot with default parameters | PlotGrafPopResults.pl | TG_50_2000_pops.txt | | | TG_50_2000_pops.png | Y | Graph saved to

# Plot results with subject races
Plot with subject races | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | | TG_50_2000_pops_race.png | Y | Graph saved to

# Plot results with subject races, dot size 5
Plot with dot 5 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 | TG_50_2000_pops_dot5.png | Y | Graph saved to

# Plot results with subject races, dot size 5, expcted areas
Plot with areas | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -areas 1,2,3,4,5,6,7,8 | TG_50_2000_pops_area1_8.png | Y | Graph saved to

# Plot results with subject races, cutoff line
Plot with cutoff lines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -cutoff | TG_50_2000_pops_cutoff.png | Y | Graph saved to

# Plot results with subject races, dot size 5, gd4
Plot with GD4 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -gd4 | TG_50_2000_pops_gd4.png | Y | Graph saved to

# Plot results with subject races, dot size 5, gd4, cutoff
Plot with GD4 + cutoff | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -gd4 -cutoff | TG_50_2000_pops_gd4_cut.png | Y | Graph saved to

# Plot results with subject races, rotate 90 degree
Plot with rotate 90 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 90 | TG_50_2000_pops_rot90.png | Y | Graph saved to

# Plot results with subject races, rotate 135 degree
Plot with rotate 135 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 135 | TG_50_2000_pops_rot135.png | Y | Graph saved to

# Plot results with subject races, rotate 265 degree
Plot with rotate 265 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 265 | TG_50_2000_pops_rot265.png | Y | Graph saved to

# Plot results with subject races, rotate 400 degree
Plot with rotate 400 degree | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -rotx 400 | TG_50_2000_pops_rot400.png | Y | Graph saved to

# Plot results with subject races, window size 600
Plot with window size 600 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -gw 600 | TG_50_2000_pops_gw600.png | Y | Graph saved to

# Plot results with subject races, window size 200
Plot with window size 200 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -gw 200 | TG_50_2000_pops_gw200.png | Y | Graph saved to

# Plot results with subject races, set y-axis limits
Plot with y-axis limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 0.9 -ymax 1.7 | TG_50_2000_pops_ymin_0.9.png | Y | Graph saved to

# Plot results with subject races, set x-axis limits
Plot with x-axis limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.6 -xmax 1.8 -ymax 1.2 | TG_50_2000_pops_xmin_1.6.png | Y | Graph saved to

# Plot results with subject races, limits with many digits
Plot with multi-digit limits | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.354 -xmax 1.671 -ymax 1.26 -ymax 1.753 | TG_50_2000_pops_xmin_1.354.png | Y | Graph saved to

# Plot results with subject races, too large y-axis range
Plot with large y range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 0 -ymax 5 | TG_50_2000_pops_large_y_range.png |  | ERROR in parameter settings

# Plot results with subject races, too small y-axis range
Plot with small y range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ymin 1.22 -ymax 1.23 | TG_50_2000_pops_small_y_range.png |  | ERROR in parameter settings

# Plot results with subject races, too large x-axis range
Plot with large x range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 0 -xmax 5 | TG_50_2000_pops_large_x_range.png |  | ERROR in parameter settings

# Plot results with subject races, too small x-axis range
Plot with small x range | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xmin 1.45 -xmax 1.5 | TG_50_2000_pops_small_x_range.png |  | ERROR in parameter settings

# Plot results with subject races, minsnp set
Plot with min snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -minsnp 1835 | TG_50_2000_pops_minsnp.png | Y | Graph saved to

# Plot results with subject races, maxsnp set
Plot with max snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -maxsnp 1834 | TG_50_2000_pops_maxsnp.png | Y | Graph saved to

# Plot results with subject races, invalid snp counts
Plot with invalid snps | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 50000 | TG_50_2000_pops_invlid_snp.png |  | ERROR: No samples with genotype ancestry SNPs

# Plot results with subject races, selected self-reported populations
Plot with selected races 1,2,3 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 1,2,3 | TG_50_2000_pops_race1_2_3.png | Y | Graph saved to

# Plot results with subject races, selected self-reported populations
Plot with selected races 5,2 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 5,2 | TG_50_2000_pops_race5_2.png | Y | Graph saved to

# Plot results with subject races, invalid races
Plot with selected races 0,8 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 0,d,3,8 | TG_50_2000_pops_inv_races.png | Y | Graph saved to

# Plot results with subject races, selected races, gd4
Plot with selected races + GD4 | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 4,1,2 -gd4 | TG_50_2000_pops_races_gd4.png | Y | Graph saved to

# Plot results with subject races, selected races, rotation
Plot with selected races + rotx | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -dot 5 -pops 4,1,2 -rotx 90 | TG_50_2000_pops_races_rotx.png | Y | Graph saved to

# Plot results with invalid input GrafPop result file
Plot with invalid pop file | PlotGrafPopResults.pl | TG_invalid_pop_res.txt | TGP_SbjSuperPop.txt | | TG_invlid_pop_file.png | | ERROR: Invalid input file

# Plot results with invalid subject race file
Plot with invalid race file | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TG_invalid_race.txt| | TG_invalid_race.png | Y | WARNING: No subject races found in

# Plot results with no subject match in subject race file
Plot with no match race file | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TG_nomatch_race.txt| | TG_nomatch_race.png | Y | WARNING: No race values found in

# Plot results with subject races, set parameter for EFA
Plot with EFA cutlines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ecut 85 -fcut 90 -acut 90 | TG_50_2000_pops_efa_cut.png | Y | Graph saved to

# Plot results with subject races, set parameter for hispanics
Plot with OH cutlines | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ohcut 10 -fhcut 60 | TG_50_2000_pops_oh_cut.png | Y | Graph saved to

# Plot results with subject races, invalid ecut + ohcut
Plot with invalid ecut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ecut 80 -fcut 90 -ohcut 10 | TG_50_2000_pops_efa_err+ecut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid fcut
Plot with invalid fcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -fcut 99 | TG_50_2000_pops_efa_err+fcut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid acut
Plot with invalid acut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -acut 99 | TG_50_2000_pops_efa_err+acut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid fhcut
Plot with invalid fhcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -fhcut 90 | TG_50_2000_pops_efa_err+fhcut.png |  | ERROR in parameter settings

# Plot results with subject races, invalid ohcut
Plot with invalid ohcut | PlotGrafPopResults.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -ohcut 60 | TG_50_2000_pops_efa_err+ohcut.png |  | ERROR in parameter settings


############### The following test cases test Perl script SaveSamples.pl

# Save samples with default settings
Save samples with default parameters | SaveSamples.pl | TG_50_2000_pops.txt | | | TG_50_2000_smps.txt | Y | were selected and saved

# Save samples with self-reported races
Save samples with races | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| | TG_50_2000_smps_race.txt | Y | were selected and saved

# Save samples with population cutlines
Save samples with cutlines set | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| -ecut 97 -acut 98 | TG_50_2000_smps_pop_cut.txt | Y | were selected and saved

# Save samples with xcmin set
Save samples with xcmin | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt| -xcmin 1.65 | TG_50_2000_smps_xcmin1.65.txt | Y | were selected and saved

# Save samples within a rectangle area set
Save samples within rect area  | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xcmin 1.45 -xcmax 1.65 -ycmin 1.25 -ycmax 1.38 | TG_50_2000_smps_rect.txt | Y | were selected and saved

# Save samples outside a rectangle area set
Save samples outside rect area  | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -xcmin 1.45 -xcmax 1.65 -ycmin 1.25 -ycmax 1.38 -isByd | TG_50_2000_smps_rect_byd.txt | Y | were selected and saved

# Save samples with min snps
Save samples with min snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 1834 | TG_50_2000_smps_minsnp.txt | Y | were selected and saved

# Save samples with max snps
Save samples with max snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -maxsnp 1835 | TG_50_2000_smps_minsnp.txt | Y | were selected and saved

# Save samples with invalid input GrafPop result file
Save samples with invalid pop file | SaveSamples.pl | TG_invalid_pop_res.txt | TGP_SbjSuperPop.txt | | TG_invalid_pop_file.txt | | ERROR: Invalid input file

# Save samples with empty input GrafPop result file
Save samples with empty pop file | SaveSamples.pl | TG_empty_pops.txt | TGP_SbjSuperPop.txt | | TG_empty_pop_file.txt | | ERROR: No sample found

# Save samples with large min snps
Save samples with large min snps | SaveSamples.pl | TG_50_2000_pops.txt | TGP_SbjSuperPop.txt | -minsnp 60000 | TG_50_2000_smps_big_snps.txt | | ERROR: No samples with genotype




